{"ast":null,"code":"import * as cheerio from \"cheerio\";\nimport axios from \"axios\";\nfunction buildDefineURI(url, bypassCors) {\n  if (bypassCors) {\n    if (typeof bypassCors === \"boolean\") {\n      return bypassCors ? `https://api.allorigins.win/get?url=${encodeURIComponent(url)}` : url;\n    } else {\n      const {\n        customURI\n      } = bypassCors;\n      return customURI ? `${customURI}${encodeURIComponent(url)}` : `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\n    }\n  } else {\n    return url;\n  }\n}\nfunction buildbodyHTML(response, bypassCors) {\n  if (bypassCors) {\n    if (typeof bypassCors === \"boolean\") {\n      return response.data.contents;\n    } else {\n      const {\n        paramExstract\n      } = bypassCors;\n      return paramExstract ? response.data[paramExstract] : response.data;\n    }\n  } else {\n    return response.data;\n  }\n}\nexport async function scrapeHtmlWeb(options) {\n  let result = [];\n  const {\n    url,\n    mainSelector,\n    childrenSelector,\n    list,\n    bypassCors\n  } = options || {};\n  const defineURI = buildDefineURI(url, bypassCors);\n  try {\n    // Use axios for HTTP requests\n    const response = await axios.get(defineURI);\n    const bodyHTML = buildbodyHTML(response, bypassCors);\n    const $ = cheerio.load(bodyHTML);\n    $(mainSelector).children().each((_, parentElem) => {\n      let obj = {};\n      childrenSelector.forEach(el => {\n        const {\n          key,\n          selector,\n          attr,\n          type,\n          canBeEmpty,\n          replace\n        } = el;\n        const value = $(parentElem).find(selector).length ? $(parentElem).find(selector) : $(parentElem);\n        if (!attr && !type) {\n          let text = value.text().trim();\n          if (replace) {\n            if (replace instanceof RegExp) {\n              text = text.replace(replace, \"\");\n            } else if (typeof replace === \"function\") {\n              text = replace(text);\n            }\n          }\n          obj = {\n            ...obj,\n            [key]: text\n          };\n        }\n        if (attr && attr !== \"\") {\n          if (value.attr(attr) || canBeEmpty) {\n            obj = {\n              ...obj,\n              [key]: value.attr(attr)\n            };\n          }\n        } else if (type === \"text\") {\n          if (value.text().trim() || canBeEmpty) {\n            let text = value.text().trim();\n            if (replace) {\n              if (replace instanceof RegExp) {\n                text = text.replace(replace, \"\");\n              } else if (typeof replace === \"function\") {\n                text = replace(text);\n              }\n            }\n            obj = {\n              ...obj,\n              [key]: text\n            };\n          }\n        } else if (type === \"html\") {\n          if (value.prop(\"outerHTML\") || canBeEmpty) {\n            let html = value.prop(\"outerHTML\");\n            if (replace) {\n              if (replace instanceof RegExp) {\n                if (html) {\n                  html = html.replace(replace, \"\");\n                }\n              } else if (typeof replace === \"function\") {\n                if (html) {\n                  html = replace(html);\n                }\n              }\n            }\n            obj = {\n              ...obj,\n              [key]: html\n            };\n          }\n        }\n      });\n      if (Object.keys(obj).length) {\n        result.push(obj);\n      }\n      if (!list) {\n        return false;\n      }\n    });\n  } catch (err) {\n    console.error(\"Error during request:\", err);\n    throw err;\n  }\n  return result;\n}\nexport default {\n  scrapeHtmlWeb\n};","map":{"version":3,"names":["cheerio","axios","buildDefineURI","url","bypassCors","encodeURIComponent","customURI","buildbodyHTML","response","data","contents","paramExstract","scrapeHtmlWeb","options","result","mainSelector","childrenSelector","list","defineURI","get","bodyHTML","$","load","children","each","_","parentElem","obj","forEach","el","key","selector","attr","type","canBeEmpty","replace","value","find","length","text","trim","RegExp","prop","html","Object","keys","push","err","console","error"],"sources":["/Users/chuongdan/Documents/code-quest/node_modules/scrape-html-web/lib/esm/index.mjs"],"sourcesContent":["import * as cheerio from \"cheerio\";\r\nimport axios from \"axios\";\r\nfunction buildDefineURI(url, bypassCors) {\r\n    if (bypassCors) {\r\n        if (typeof bypassCors === \"boolean\") {\r\n            return bypassCors\r\n                ? `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`\r\n                : url;\r\n        }\r\n        else {\r\n            const { customURI } = bypassCors;\r\n            return customURI\r\n                ? `${customURI}${encodeURIComponent(url)}`\r\n                : `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`;\r\n        }\r\n    }\r\n    else {\r\n        return url;\r\n    }\r\n}\r\nfunction buildbodyHTML(response, bypassCors) {\r\n    if (bypassCors) {\r\n        if (typeof bypassCors === \"boolean\") {\r\n            return response.data.contents;\r\n        }\r\n        else {\r\n            const { paramExstract } = bypassCors;\r\n            return paramExstract ? response.data[paramExstract] : response.data;\r\n        }\r\n    }\r\n    else {\r\n        return response.data;\r\n    }\r\n}\r\nexport async function scrapeHtmlWeb(options) {\r\n    let result = [];\r\n    const { url, mainSelector, childrenSelector, list, bypassCors } = options || {};\r\n    const defineURI = buildDefineURI(url, bypassCors);\r\n    try {\r\n        // Use axios for HTTP requests\r\n        const response = await axios.get(defineURI);\r\n        const bodyHTML = buildbodyHTML(response, bypassCors);\r\n        const $ = cheerio.load(bodyHTML);\r\n        $(mainSelector)\r\n            .children()\r\n            .each((_, parentElem) => {\r\n            let obj = {};\r\n            childrenSelector.forEach((el) => {\r\n                const { key, selector, attr, type, canBeEmpty, replace } = el;\r\n                const value = $(parentElem).find(selector).length\r\n                    ? $(parentElem).find(selector)\r\n                    : $(parentElem);\r\n                if (!attr && !type) {\r\n                    let text = value.text().trim();\r\n                    if (replace) {\r\n                        if (replace instanceof RegExp) {\r\n                            text = text.replace(replace, \"\");\r\n                        }\r\n                        else if (typeof replace === \"function\") {\r\n                            text = replace(text);\r\n                        }\r\n                    }\r\n                    obj = { ...obj, [key]: text };\r\n                }\r\n                if (attr && attr !== \"\") {\r\n                    if (value.attr(attr) || canBeEmpty) {\r\n                        obj = { ...obj, [key]: value.attr(attr) };\r\n                    }\r\n                }\r\n                else if (type === \"text\") {\r\n                    if (value.text().trim() || canBeEmpty) {\r\n                        let text = value.text().trim();\r\n                        if (replace) {\r\n                            if (replace instanceof RegExp) {\r\n                                text = text.replace(replace, \"\");\r\n                            }\r\n                            else if (typeof replace === \"function\") {\r\n                                text = replace(text);\r\n                            }\r\n                        }\r\n                        obj = { ...obj, [key]: text };\r\n                    }\r\n                }\r\n                else if (type === \"html\") {\r\n                    if (value.prop(\"outerHTML\") || canBeEmpty) {\r\n                        let html = value.prop(\"outerHTML\");\r\n                        if (replace) {\r\n                            if (replace instanceof RegExp) {\r\n                                if (html) {\r\n                                    html = html.replace(replace, \"\");\r\n                                }\r\n                            }\r\n                            else if (typeof replace === \"function\") {\r\n                                if (html) {\r\n                                    html = replace(html);\r\n                                }\r\n                            }\r\n                        }\r\n                        obj = { ...obj, [key]: html };\r\n                    }\r\n                }\r\n            });\r\n            if (Object.keys(obj).length) {\r\n                result.push(obj);\r\n            }\r\n            if (!list) {\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n    catch (err) {\r\n        console.error(\"Error during request:\", err);\r\n        throw err;\r\n    }\r\n    return result;\r\n}\r\nexport default {\r\n    scrapeHtmlWeb,\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}